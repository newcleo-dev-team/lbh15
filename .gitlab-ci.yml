# Test all scripts in tests/ and publish html documentation

test-all-test:
  stage: test
  script:
  - cd tests/
  - python3 test_lbh15_fromX.py -v
  - python3 test_lbh15_static.py -v
  - python3 test_lead_basics.py -v
  tags:
    - shell_newcleo
    
documentation:
  stage: deploy
  before_script:
    - mkdir public
    - ls -lht
  script:
    - cd docs
    - make html
    - ls -lht _build/html/
    - cd ..
    - cp -r docs/_build/html/* public/
  tags:
  - shell_newcleo
  artifacts:
    paths:
    - public
  rules:
    - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH

installation:
  stage: deploy
  script:
    - python3 -m venv env_lbh15
    - source env_lbh15/bin/activate 
    - pip install wheel
    - pip install .
    - deactivate
    - rm -rf env_lbh15/
  tags:
  - shell_newcleo
  rules:
    - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH
